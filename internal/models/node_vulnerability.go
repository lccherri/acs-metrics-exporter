package models

import "time"

type NodeComponent struct {
    Name    string `json:"name"`
    Version string `json:"version"`
    FixedIn string `json:"fixedIn"`
}

type Node struct {
    ID              string  `json:"id"`
    Name            string  `json:"name"`
    OperatingSystem string  `json:"operatingSystem"`
    Cluster         Cluster `json:"cluster"`
}

type NodeVulnerability struct {
    BaseVulnerability
    NodeCount          int             `json:"nodeCount"`
    SuppressActivation *time.Time      `json:"suppressActivation,omitempty"`
    SuppressExpiry     *time.Time      `json:"suppressExpiry,omitempty"`
    Suppressed         bool            `json:"suppressed"`
    NodeComponents     []NodeComponent `json:"nodeComponents"`
    Nodes              []Node          `json:"nodes"`
}

type NodeVulnerabilityResponse struct {
    Data struct {
        NodeVulnerabilities []NodeVulnerability `json:"nodeVulnerabilities"`
    } `json:"data"`
}