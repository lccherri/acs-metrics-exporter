package models

import "time"

type Deployment struct {
    ID        string  `json:"id"`
    Name      string  `json:"name"`
    Namespace string  `json:"namespace"`
    Cluster   Cluster `json:"cluster"`
}

type Image struct {
    ID              string    `json:"id"`
    FullName        string    `json:"fullName"`
    OperatingSystem string    `json:"operatingSystem"`
    ScanTime        time.Time `json:"scanTime"`
    Priority        int       `json:"priority"`
}

type ImageVulnerability struct {
    BaseVulnerability
    ID                  string       `json:"id"`
    CreatedAt           time.Time    `json:"createdAt"`
    DiscoveredAtImage   time.Time    `json:"discoveredAtImage"`
    EnvImpact           float64      `json:"envImpact"`
    ImpactScore         float64      `json:"impactScore"`
    LastModified        time.Time    `json:"lastModified"`
    LastScanned         time.Time    `json:"lastScanned"`
    OperatingSystem     string       `json:"operatingSystem"`
    VulnerabilityState  string       `json:"vulnerabilityState"`
    ComponentCount      int          `json:"componentCount"`
    ImageCount          int          `json:"imageCount"`
    DeploymentCount     int          `json:"deploymentCount"`
    Deployments         []Deployment `json:"deployments"`
    Images              []Image      `json:"images"`
    SuppressActivation  *time.Time   `json:"suppressActivation,omitempty"`
    SuppressExpiry      *time.Time   `json:"suppressExpiry,omitempty"`
    Suppressed          bool         `json:"suppressed"`
}

type ImageVulnerabilityResponse struct {
    Data struct {
        ImageVulnerabilities []ImageVulnerability `json:"imageVulnerabilities"`
    } `json:"data"`
}
