package models

type Deployment struct {
    ID        string        `json:"id"`
    Name      string        `json:"name"`
    Namespace string        `json:"namespace"`
    PlatformComponent bool  `json:"platformComponent"`
    Cluster   Cluster       `json:"cluster"`
}

type Image struct {
    ID              string       `json:"id"`
    Name            ImageName    `json:"name"`
    OperatingSystem string       `json:"operatingSystem"`
    ScanTime        *string      `json:"scanTime"`
    Priority        int          `json:"priority"`
    Deployments     []Deployment `json:"deployments"`
}

type ImageName struct {
    Registry    string `json:"registry"`
    Remote      string `json:"remote"`
    Tag         string `json:"tag"`
    FullName    string `json:"fullName"`
}

type ImageVulnerability struct {
    BaseVulnerability
    DiscoveredAtImage   *string      `json:"discoveredAtImage"`
    OperatingSystem     string       `json:"operatingSystem"`
    VulnerabilityState  string       `json:"vulnerabilityState"`
    Images              []Image      `json:"images"`
    // Deployments         []Deployment `json:"deployments"`
    // DeploymentCount     int          `json:"deploymentCount"`
    // ID                  string       `json:"id"`
    // ComponentCount      int          `json:"componentCount"`
    // ImageCount          int          `json:"imageCount"`
}

type ImageVulnerabilityResponse struct {
    Data struct {
        ImageVulnerabilities []ImageVulnerability `json:"imageVulnerabilities"`
    } `json:"data"`
}
